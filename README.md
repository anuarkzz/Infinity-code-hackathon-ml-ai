# Infinity-code-hackathon-ml-ai
Code for detecting threats for hackathon 

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–∞. –û–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–æ—Ç–æ—Ç–∏–ø —Å–∏—Å—Ç–µ–º—ã –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ –∏ –≤—ã—è–≤–ª—è–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ **—Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** —Å –ø–æ–º–æ—â—å—é –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

## ‚ú® –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- üìä **–ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CSV-—Ñ–∞–π–ª–æ–≤, PCAP-–∑–∞—Ö–≤–∞—Ç–æ–≤ –∏ live-—Ä–µ–∂–∏–º–∞ —Å —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.  
- ü§ñ **ML-–∞–Ω–∞–ª–∏–∑**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IsolationForest –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π –≤ –ø–æ—Ç–æ–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö.  
- üö® **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã**: –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.  
- üîó **Webhook-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –æ—Ç–ø—Ä–∞–≤–∫–∞ JSON-–æ–ø–æ–≤–µ—â–µ–Ω–∏–π –≤–æ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, SIEM).  
- üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∞–Ω–æ–º–∞–ª–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É, –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –≤–∫–ª—é—á–∏—Ç—å DPI).  

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/<–í–ê–®-–õ–û–ì–ò–ù>/infinity-code-hackathon.git
cd infinity-code-hackathon
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

3. –î–ª—è **PCAP –∏ live-—Ä–µ–∂–∏–º–∞** –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `tshark`:
```bash
# Ubuntu/Debian
sudo apt install tshark

# MacOS
brew install wireshark
```

##  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. Offline –∞–Ω–∞–ª–∏–∑ (CSV)
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–º CSV:
```bash
python detector.py --csv traffic.csv
```
CSV –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è:
```
ts,src,dst,length,proto,sport,dport,tcp_flags
```
–ü—Ä–∏–º–µ—Ä CSV —É–∂–µ –µ—Å—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (`traffic.csv`)

### 2. –ê–Ω–∞–ª–∏–∑ PCAP-—Ñ–∞–π–ª–∞
```bash
python detector.py --pcap sample.pcap
```

### 3. Live-—Ä–µ–∂–∏–º (—Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
```bash
sudo python detector.py --iface eth0 --window 10
```
–ì–¥–µ:
- `eth0` ‚Äî –∏–º—è —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ `ifconfig` –∏–ª–∏ `ip a`).
- `--window 10` ‚Äî —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö.

### 4. Webhook –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤
–ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä:
```bash
python detector.py --csv traffic.csv --webhook http://localhost:5000/alert
```

## üìÇ –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞
```text
[ALERT] 192.168.0.10 -> 8.8.8.8 score=0.934 reason=high_bytes
{
  "timestamp": "2025-10-02T15:30:00Z",
  "src": "192.168.0.10",
  "dst": "8.8.8.8",
  "pkt_count": 10,
  "byte_sum": 1200000,
  "score": 0.934,
  "reason": "high_bytes",
  "recommendation": "Check payload, limit connection, enable DPI."
